<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>$TITLE$</title>
    <link href="$CSS_URL$" rel="stylesheet" type="text/css" media="all">
    <style>
    </style>
</head>
<body>

<div class="box">

    <div class="header">
        <h1>
            <a href="$LINK_URL$">$TITLE$</a>
        </h1>
        <div class="link">
            <a href="$LINK_URL$">
                $LINK_TEXT$
            </a>
        </div>
    </div>

    <div class="main">
        <iframe src="$IFRAME_URL$" frameborder="0"></iframe>
    </div>
</div>
</body>

<script>
    document.body.dataset.devicePixelRatio = '' + window.devicePixelRatio;

    console.log("chrome", typeof chrome);
    const $frame = document.querySelector('iframe');
    window.addEventListener('message', function (messageEvent) {
        if (messageEvent.data.call === 'helloFromFrame') {
            const dataUri = messageEvent.data.dataUri;
            // console.log("parent received", dataUri);
            document.querySelector('.main').style.backgroundImage = 'url(' + dataUri + ')';
            $frame.parentNode.removeChild($frame);
        }
    });
    $frame.addEventListener("load", function () {
        // pass the original url to the frame, so we can redirect user to it onlick
        const url = document.querySelector('.link a').href;
        $frame.contentWindow.postMessage({call: 'setFrameParams', url: url}, '*');
    });
</script>

</html>